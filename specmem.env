# ╔═══════════════════════════════════════════════════════════════════════════╗
# ║          ⚠️  HERE'S WHERE BOTH OF US ARE GOING TO FUCK UP  ⚠️              ║
# ╠═══════════════════════════════════════════════════════════════════════════╣
# ║  Hey, changing shit here might break SpecMem! Be careful.                 ║
# ║                                                                           ║
# ║  I hope to god you know what you're doing because I, Jon Hardwick,        ║
# ║  dev of this project, can assure you I don't have a damn clue either.     ║
# ║  This whole codebase is hell to go through - it took 6 months of          ║
# ║  development, so please be cautious.                                      ║
# ║                                                                           ║
# ║  Your custom settings are preserved in: specmem/user-config.json          ║
# ║  (That file survives specmem-init and updates)                            ║
# ║                                                                           ║
# ║  If you break something, try: specmem-init --reset-env                    ║
# ╚═══════════════════════════════════════════════════════════════════════════╝
#
# SpecMem Configuration - THE BRAIN OF CLAUDE
# ============================================
# Standalone memory server with local embeddings
# No external API dependencies required

# ==== UNIFIED PASSWORD ====
# Set this single variable to configure all passwords at once
# Individual passwords below will override if set
SPECMEM_PASSWORD=specmem_westayunprofessional

# ============================================
# DATABASE CONFIGURATION
# ============================================
# !!! YO, DONT TOUCH THIS SHIT OR IT MIGHT BREAK !!!
# Multi-instance isolation is HARD. These credentials are auto-configured
# for per-project database isolation. Changing them manually can cause:
#   - Permission errors ("must be owner of...")
#   - Cross-project data leakage
#   - Socket path collisions
#   - Orphaned embedding processes
# If you need a different setup, use SPECMEM_PASSWORD above and let
# bootstrap.cjs auto-configure everything else.
# ============================================
SPECMEM_DB_HOST=localhost
SPECMEM_DB_PORT=5432
SPECMEM_DB_NAME=specmem_westayunprofessional
SPECMEM_DB_USER=specmem_westayunprofessional
SPECMEM_DB_PASSWORD=specmem_westayunprofessional
SPECMEM_DB_MAX_CONNECTIONS=20

# File Watcher (auto-update memories when code changes)
# ENABLED BY DEFAULT - SpecMem monitors your codebase automatically
SPECMEM_WATCHER_ENABLED=true

# Session Watcher (Claude chat sessions)
SPECMEM_SESSION_WATCHER_ENABLED=true

# ============================================
# SKILLS SYSTEM - Drag & Drop .md Files
# ============================================
# Enable/disable the skills system
SPECMEM_SKILLS_ENABLED=true

# Path to skills directory (recursive scanning)
# Defaults to ./skills relative to cwd. Override with environment variable.
SPECMEM_SKILLS_PATH=./skills

# Auto-reload when skills files change
SPECMEM_SKILLS_AUTO_RELOAD=true

# ============================================
# CODEBASE INDEXER - Full Project Awareness
# ============================================
# Enable/disable codebase indexing
SPECMEM_CODEBASE_ENABLED=true

# Root path to index (your entire project)
# Defaults to current working directory. Override with environment variable.
SPECMEM_CODEBASE_PATH=.

# Patterns to exclude (comma-separated)
SPECMEM_CODEBASE_EXCLUDE_PATTERNS=node_modules,.git,dist,build,.next,coverage,__pycache__,.pytest_cache,venv,.venv

# Watch for file changes and auto-update index
SPECMEM_CODEBASE_WATCH=true

# ============================================
# EMBEDDING CONFIGURATION
# ============================================
# Local embeddings - fully standalone, no API needed

# Embedding socket path - DYNAMIC DETECTION (recommended)
# Leave commented out to enable automatic socket detection in this order:
# 1. SPECMEM_EMBEDDING_SOCKET env var (explicit override - HIGHEST PRIORITY)
# 2. ~/.specmem/instances/{project_dir}/sockets/embeddings.sock (project-scoped, readable name)
# 3. /tmp/specmem-{project_dir}/sockets/embeddings.sock (project-isolated Docker mount)
# 4. {SPECMEM_ROOT}/run/embeddings.sock (SpecMem installation directory)
# 5. {SPECMEM_ROOT}/run/sockets/embeddings.sock (SpecMem run/sockets)
# 6. {SPECMEM_HOME}/run/embeddings.sock (SPECMEM_HOME defaults to SPECMEM_ROOT, NOT ~/.claude!)
# 7. ~/.specmem/instances/{project_hash}/sockets/embeddings.sock (hash-based, backwards compat)
# 8. /sockets/embeddings.sock (container internal path)
# 9. /tmp/specmem-sockets/embeddings.sock (DEPRECATED legacy path)
#
# NOTE: SPECMEM_HOME now defaults to the SpecMem installation directory (e.g., /specmem)
# This ensures socket paths work for BOTH /specmem and any other project using SpecMem
#
# Only uncomment to force a specific path:
# SPECMEM_EMBEDDING_SOCKET=/tmp/specmem-myproject/sockets/embeddings.sock

# IMPORTANT: Embedding dimensions are AUTO-DETECTED from the database!
# Do NOT configure dimensions manually - the system dynamically detects
# the dimension from the pgvector column in PostgreSQL.
# SPECMEM_EMBEDDING_DIMENSIONS is DEPRECATED and should NOT be used.
# The dimension is determined by:
# 1. The Frankenstein embedding model (384 dims for MiniLM)
# 2. The pgvector column definition in the memories table
# Any dimension mismatch is auto-migrated at startup.

# ============================================
# COORDINATION SERVER
# ============================================
# Enable coordination server for multi-team member communication
SPECMEM_COORDINATION_ENABLED=true
SPECMEM_COORDINATION_HOST=0.0.0.0
SPECMEM_COORDINATION_PORT=8596

# ============================================
# WEB DASHBOARD (CSGO-Themed)
# ============================================
# Enable the web dashboard
SPECMEM_DASHBOARD_ENABLED=true

# Dashboard access mode:
# - 'private' (default): Localhost only (127.0.0.1), most secure
# - 'public': Network accessible (binds to SPECMEM_DASHBOARD_HOST)
# WARNING: Public mode exposes the dashboard to your network!
SPECMEM_DASHBOARD_MODE=private

# Host to bind to (only used in public mode)
# 0.0.0.0 = all network interfaces
# Use specific IP to restrict to one interface
SPECMEM_DASHBOARD_HOST=0.0.0.0

# Dashboard port (default: 8585)
SPECMEM_DASHBOARD_PORT=8585

# Dashboard password - CHANGE THIS for public mode!
SPECMEM_DASHBOARD_PASSWORD=specmem_westayunprofessional

# ============================================
# MEMORY MANAGEMENT (Dashboard Controls)
# ============================================
# Maximum memory allocation in MB (50-200)
SPECMEM_MEMORY_LIMIT=250
SPECMEM_MAX_HEAP_MB=250

# Overflow cleanup time in hours (0-72)
# Memories older than this (with low importance/access) get auto-cleaned
SPECMEM_OVERFLOW_TIME=24

# Embedding cache size (number of entries 100-1000)
SPECMEM_CACHE_SIZE=500

# ============================================
# LOGGING
# ============================================
SPECMEM_LOG_LEVEL=info
SPECMEM_LOG_PRETTY=false
# Terminal fix - loads on every claude session in this project
# NOTE: Commented out - this module may not exist in all environments
# NODE_OPTIONS="--require /usr/lib/node_modules/claudescreenfix-hardwicksoftware/loader.cjs ${NODE_OPTIONS}"

# ============================================
# MCP TRANSPORT RESILIENCE
# ============================================
# Configuration for the resilient MCP transport layer.
# These settings control connection health monitoring, keepalive, and recovery.
# All values are in milliseconds unless noted otherwise.

# Health check interval - how often to check connection health (default: 30000ms = 30s)
# SPECMEM_TRANSPORT_HEALTH_INTERVAL=30000

# Inactivity threshold - time without activity before considering connection degraded (default: 300000ms = 5 min)
# SPECMEM_TRANSPORT_INACTIVITY_THRESHOLD=300000

# Max errors before shutdown - number of errors before giving up (default: 10)
# SPECMEM_TRANSPORT_MAX_ERRORS=10

# Debug mode - enable verbose debug logging for transport (default: false)
# SPECMEM_TRANSPORT_DEBUG=false

# Keepalive interval - how often to send keepalive pings (default: 60000ms = 60s)
# SPECMEM_TRANSPORT_KEEPALIVE_INTERVAL=60000

# Enable keepalive - set to 'false' to disable keepalive pings (default: true)
# SPECMEM_TRANSPORT_KEEPALIVE_ENABLED=true

# Enable recovery - set to 'false' to disable exponential backoff recovery (default: true)
# SPECMEM_TRANSPORT_RECOVERY_ENABLED=true

# Max recovery attempts - number of recovery attempts before giving up (default: 5)
# SPECMEM_TRANSPORT_RECOVERY_MAX_ATTEMPTS=5

# Recovery base delay - initial delay for exponential backoff (default: 1000ms = 1s)
# SPECMEM_TRANSPORT_RECOVERY_BASE_DELAY=1000

# Recovery max delay - maximum delay cap for backoff (default: 30000ms = 30s)
# SPECMEM_TRANSPORT_RECOVERY_MAX_DELAY=30000

# Recovery multiplier - multiplier for exponential backoff (default: 2)
# SPECMEM_TRANSPORT_RECOVERY_MULTIPLIER=2

# Stdin grace period - time after startup before treating stdin close as disconnect (default: 5000ms = 5s)
# SPECMEM_TRANSPORT_STDIN_GRACE_PERIOD=5000

# Shutdown grace period - time to wait before shutdown after connection loss (default: 100ms)
# SPECMEM_TRANSPORT_SHUTDOWN_GRACE_PERIOD=100

# Transport connect timeout - max time to wait for initial transport connection (default: 10000ms = 10s)
# SPECMEM_TRANSPORT_CONNECT_TIMEOUT=10000
